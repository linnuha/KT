<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pojok Curhat Karang Taruna</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #f8f9fa;
    }
    .form-container {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .form-content {
      flex: 1;
      overflow-y: auto;
      padding: 2rem;
    }
    .form-section {
      background: white;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 2rem;
    }
    h5 {
      margin-top: 1rem;
      margin-bottom: 1rem;
      color: #0d6efd;
    }
    .form-label {
      font-weight: 500;
    }
    .navigation-buttons,
    .submit-button-container {
      display: flex;
      justify-content: space-between;
      padding: 1rem 2rem;
      background: #fff;
      border-top: 1px solid #dee2e6;
    }
    .submit-button-container {
      display: none;
    }
  </style>
</head>
<body>
<div class="form-container">
  <div class="form-content container">
    <h2 class="text-center mb-4 fw-bold">📝 Pojok Curhat Karang Taruna</h2>

    <div id="formAlert" class="alert alert-success d-none" role="alert">
      ✅ Data berhasil dikirim yaa sobs!
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <form id="karangTarunaForm">
      <!-- 🧑 A. Identitas Pengisi -->
      <div class="form-section">
        <h5>🧑 A. Identitas Pengisi</h5>
        <div class="mb-3">
          <label class="form-label">Nama Lengkap</label>
          <input type="text" class="form-control" name="nama" required>
        </div>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">Umur</label>
            <input type="number" class="form-control" name="umur">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Jenis Kelamin</label>
            <select class="form-select" name="jk" required>
              <option disabled selected value="">-- Pilih Jenis Kelamin --</option>
              <option>Laki-laki</option>
              <option>Perempuan</option>
            </select>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">Jabatan di Karang Taruna</label>
          <select class="form-select" name="jabatan" required>
            <option disabled selected value="">-- Pilih Jabatan --</option>
            <option>Ketua</option>
            <option>Sekretaris</option>
            <option>Bendahara</option>
            <option>Anggota</option>
            <option>Lainnya</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Kontak (Opsional)</label>
          <input type="tel" class="form-control" name="kontak" placeholder="081234567890" pattern="^(\+62|0)[0-9]{9,13}$">
        </div>
      </div>

      <!-- 📂 B. Kategori Masalah Umum -->
      <div class="form-section">
        <h5>📂 B. Kategori Masalah Umum</h5>
        <div class="mb-3 row row-cols-1 row-cols-md-2 g-2">
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Kurangnya partisipasi anggota"><label class="form-check-label">Kurangnya partisipasi anggota</label></div></div>
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Keterbatasan dana"><label class="form-check-label">Keterbatasan dana</label></div></div>
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Tidak ada program kerja"><label class="form-check-label">Tidak ada program kerja</label></div></div>
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Fasilitas tidak memadai"><label class="form-check-label">Fasilitas tidak memadai</label></div></div>
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Kurangnya pelatihan"><label class="form-check-label">Kurangnya pelatihan</label></div></div>
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Minimnya dukungan desa"><label class="form-check-label">Minimnya dukungan desa</label></div></div>
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Konflik internal"><label class="form-check-label">Konflik internal</label></div></div>
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Kurangnya komunikasi"><label class="form-check-label">Kurangnya komunikasi</label></div></div>
          <div class="col"><div class="form-check"><input class="form-check-input" type="checkbox" name="masalah[]" value="Kegiatan tidak berkelanjutan"><label class="form-check-label">Kegiatan tidak berkelanjutan</label></div></div>
        </div>
        <input type="text" class="form-control mt-3" name="masalah_lain" placeholder="Lainnya (sebutkan)">
      </div>

      <!-- 📖 C. Uraian Masalah -->
      <div class="form-section">
        <h5>📖 C. Uraian Masalah</h5>
        <textarea class="form-control" name="uraian" rows="3" required></textarea>
      </div>

      <!-- 🚨 D. Skala Urgensi -->
      <div class="form-section">
        <h5>🚨 D. Skala Urgensi</h5>
        <select class="form-select" name="urgensi" required>
          <option disabled selected value="">-- Pilih Tingkat Urgensi --</option>
          <option value="1">1 - Tidak Mendesak</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 - Sangat Mendesak</option>
        </select>
      </div>

      <!-- 🌟 E. Usulan Solusi -->
      <div class="form-section">
        <h5>🌟 E. Usulan Solusi / Harapan</h5>
        <textarea class="form-control" name="solusi" rows="3" required></textarea>
      </div>

      <!-- 🏢 F. Permasalahan Organisasi -->
      <div class="form-section">
        <h5>🏢 F. Permasalahan Organisasi</h5>
        <!-- pertanyaan 1–3 sama seperti sebelumnya -->
        <div class="mb-3">
          <label class="form-label">Struktur organisasi terbentuk lengkap?</label><br>
          <input type="radio" name="struktur_organisasi" value="Ya" required> Ya
          <input type="radio" name="struktur_organisasi" value="Tidak"> Tidak
          <textarea class="form-control mt-2" name="hambatan_struktur" placeholder="Jika tidak, apa hambatannya?"></textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Anggota aktif dalam kegiatan?</label><br>
          <input type="radio" name="anggota_aktif" value="Ya" required> Ya
          <input type="radio" name="anggota_aktif" value="Tidak"> Tidak
          <textarea class="form-control mt-2" name="penyebab_tidak_aktif"></textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Kesulitan koordinasi pengurus?</label><br>
          <input type="radio" name="koordinasi_sulit" value="Ya" required> Ya
          <input type="radio" name="koordinasi_sulit" value="Tidak"> Tidak
          <textarea class="form-control mt-2" name="penyebab_koordinasi"></textarea>
        </div>
      </div>

      <div class="form-section">
      <h5>📅 G. Permasalahan Program Kerja</h5>
      <div class="mb-3">
        <label class="form-label">1. Apakah memiliki program kerja tahunan?</label>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="punya_program_kerja" value="Ya" required>
          <label class="form-check-label">Ya</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="punya_program_kerja" value="Tidak">
          <label class="form-check-label">Tidak</label>
        </div>
        <textarea class="form-control mt-2" name="alasan_tidak_program" placeholder="Jika tidak, kenapa?"></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">2. Kegiatan yang tidak berjalan dengan baik:</label>
        <textarea class="form-control" name="kegiatan_tidak_jalan" rows="2"></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">3. Hambatan utama dalam pelaksanaan kegiatan:</label>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="hambatan_kegiatan[]" value="Dana">
          <label class="form-check-label">Dana</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="hambatan_kegiatan[]" value="SDM">
          <label class="form-check-label">SDM</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="hambatan_kegiatan[]" value="Partisipasi masyarakat">
          <label class="form-check-label">Partisipasi masyarakat</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="hambatan_kegiatan[]" value="Fasilitas">
          <label class="form-check-label">Fasilitas/sarana prasarana</label>
        </div>
        <input type="text" class="form-control mt-2" name="hambatan_lain" placeholder="Lainnya (sebutkan)">
      </div>
    </div>

    <div class="form-section">
      <h5>🌍 H. Permasalahan Sosial di Masyarakat</h5>
      <div class="mb-3">
        <label class="form-label">1. Masalah kepemudaan yang sering terjadi:</label>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="masalah_pemuda[]" value="Pengangguran">
          <label class="form-check-label">Pengangguran</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="masalah_pemuda[]" value="Narkoba">
          <label class="form-check-label">Narkoba</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="masalah_pemuda[]" value="Kenakalan remaja">
          <label class="form-check-label">Kenakalan remaja</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="masalah_pemuda[]" value="Putus sekolah">
          <label class="form-check-label">Putus sekolah</label>
        </div>
        <input type="text" class="form-control mt-2" name="masalah_pemuda_lain" placeholder="Lainnya (sebutkan)">
      </div>
      <div class="mb-3">
        <label class="form-label">2. Masalah sosial lainnya di lingkungan:</label>
        <textarea class="form-control" name="masalah_sosial_lain" rows="2"></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">3. Upaya yang sudah dilakukan Karang Taruna:</label>
        <textarea class="form-control" name="upaya_karangtaruna" rows="2"></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">4. Apa yang dibutuhkan untuk mengatasi masalah tersebut?</label>
        <textarea class="form-control" name="kebutuhan_karangtaruna" rows="2"></textarea>
      </div>
    </div>
    </form>
  </div>

<script>
  // Tambahkan id dan for secara otomatis jika belum ada
  document.querySelectorAll('.form-check-input').forEach((input, index) => {
    const label = input.nextElementSibling;
    if (label && label.tagName === 'LABEL') {
      const id = input.name.replace(/\[\]/g, '') + '-' + index;
      input.id = id;
      label.setAttribute('for', id);
    }
  });
</script>
    </form>
  </div>

  <div class="navigation-buttons">
    <button type="button" class="btn btn-outline-secondary" onclick="navigate(-1)">⬅️ Sebelumnya</button>
    <button type="button" class="btn btn-outline-primary" onclick="navigate(1)">Selanjutnya ➡️</button>
  </div>

  <div class="submit-button-container" id="submitButtonContainer">
    <button type="submit" form="karangTarunaForm" class="btn btn-primary px-4 py-2">Kirim</button>
  </div>
</div>

<script>
  const sections = document.querySelectorAll('.form-section');
  const submitButtonContainer = document.getElementById('submitButtonContainer');
  let currentSection = 0;

  function showSection(index) {
    sections.forEach((section, i) => {
      section.style.display = i === index ? 'block' : 'none';
    });
    submitButtonContainer.style.display = index === sections.length - 1 ? 'flex' : 'none';
  }

  function navigate(direction) {
    if (direction === -1 && currentSection > 0) {
      currentSection--;
    } else if (direction === 1 && currentSection < sections.length - 1) {
      currentSection++;
    }
    showSection(currentSection);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  showSection(currentSection);

  // Kirim ke Google Apps Script
  document.getElementById("karangTarunaForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const form = e.target;
    const formData = new FormData(form);

    fetch("https://script.google.com/macros/s/AKfycbw6on0yQmN3uKdDFTpLDjLiyPxcxEC-0udmBSas6C6n9eFtx1BjxLnvNZXRgKBw26Nz/exec", {
      method: "POST",
      body: formData
    })
    .then(res => res.text())
    .then(text => {
      if (text.includes("OK")) {
        document.getElementById("formAlert").classList.remove("d-none");
        form.reset();
        currentSection = 0;
        showSection(currentSection);
        window.scrollTo({ top: 0, behavior: 'smooth' });
      } else {
        alert("❌ Gagal mengirim: " + text);
      }
    })
    .catch(err => {
      alert("❌ Error jaringan: " + err.message);
    });
  });
</script>
</body>
</html>
